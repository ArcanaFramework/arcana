<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Processing" href="processing.html" /><link rel="prev" title="Getting started" href="getting_started.html" />

    <!-- Generated with Sphinx 6.1.3 and Furo 2022.12.07 -->
        <title>Data model - Arcana v0.9.2</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  --color-brand-primary: #7b112d;
  --color-brand-content: #7b112d;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #111111;
  --color-code-foreground: #ffffff;
  --color-brand-primary: #b94e5e;
  --color-brand-content: #b94e5e;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #111111;
  --color-code-foreground: #ffffff;
  --color-brand-primary: #b94e5e;
  --color-brand-content: #b94e5e;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Arcana v0.9.2</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/logo_small.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Arcana v0.9.2</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Data model</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing.html">Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment.html">Deployment</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_analyses.html">Designing Analyses</a></li>
<li class="toctree-l1"><a class="reference internal" href="adding_formats.html">New formats and spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="alternative_stores.html">Alternative storage</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cli.html">CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="data-model">
<h1>Data model<a class="headerlink" href="#data-model" title="Permalink to this heading">#</a></h1>
<p>Arcana’s data model sets out to bridge the gap between
the semi-structured data trees that file-based data are typically stored in,
and the tabular data frames used in statistical analysis. Note that this
transformation is abstract, with the source data remaining within original data
tree and generated derivatives stored alongside them.</p>
<p>The key elements of Arcana’s data model are:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#stores"><span class="std std-ref">Stores</span></a> - encapsulations of tree-based file storage systems</p></li>
<li><p><a class="reference internal" href="#datasets"><span class="std std-ref">Datasets</span></a> - sets of comparable data to be jointly analysed</p></li>
<li><p><a class="reference internal" href="#items"><span class="std std-ref">Items</span></a> - references to data elements (files, scalars, and arrays)</p></li>
<li><p><a class="reference internal" href="#data-columns"><span class="std std-ref">Frames: Rows and Columns</span></a> - abstract tables within datasets</p></li>
<li><p><a class="reference internal" href="#data-spaces"><span class="std std-ref">Spaces</span></a> - conceptual link between tree and tabular data structures</p></li>
<li><p><a class="reference internal" href="#data-grids"><span class="std std-ref">Grids</span></a> - selection of data points to be included in an analysis</p></li>
</ul>
<section id="stores">
<h2>Stores<a class="headerlink" href="#stores" title="Permalink to this heading">#</a></h2>
<p>Support for different file storage systems (e.g. <a class="reference external" href="https://xnat.org">XNAT</a>, <a class="reference external" href="https://bids.neuroimaging.io">BIDS</a>)
is provided by sub-classes of <a class="reference internal" href="api.html#arcana.core.data.store.DataStore" title="arcana.core.data.store.DataStore"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataStore</span></code></a>. Data store
classes not only encapsulate where the data are stored, e.g. on local disk or
remote repository, but also how the data are accessed, e.g. whether to assume that
they are in BIDS format, or whether files in an XNAT archive mount can be
accessed directly (i.e. as exposed to the container service), or only via the API.</p>
<p>There are four data store classes in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">arcana.dirtree.data</span></code>
and <code class="xref py py-mod docutils literal notranslate"><span class="pre">arcana.medimage.data</span></code> arcana sub-packages:</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleStore</span></code> - access data organised within an arbitrary directory tree on the file system</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Bids</span></code> - access data on file systems organised in the <a class="reference external" href="https://bids.neuroimaging.io/">Brain Imaging Data Structure (BIDS)</a></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Xnat</span></code> - access data stored in <a class="reference external" href="https://xnat.org">XNAT</a> repositories vi its REST API</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">XnatViaCS</span></code> - access data stored in <a class="reference external" href="https://xnat.org">XNAT</a> via its <a class="reference external" href="https://wiki.xnat.org/container-service/using-the-container-service-122978908.html">container service</a></p></li>
</ul>
<p>For instructions on how to add support for new systems see <a class="reference internal" href="alternative_stores.html#alternative-stores"><span class="std std-ref">Alternative storage systems</span></a>.</p>
<p>To configure access to a store via the CLI use the ‘<a class="reference internal" href="cli.html#arcana-store-add"><span class="std std-ref">arcana store add</span></a>’ command.
The store type is specified by the path to the data store sub-class,
<em>&lt;module-path&gt;:&lt;class-name&gt;</em>,  e.g. <code class="docutils literal notranslate"><span class="pre">arcana.xnat.data:Xnat</span></code>.
However, if the store is in a submodule of <code class="docutils literal notranslate"><span class="pre">arcana.data.stores</span></code> then that
prefix can be dropped for convenience, e.g. <code class="docutils literal notranslate"><span class="pre">mediamge:Xnat</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>arcana<span class="w"> </span>store<span class="w"> </span>add<span class="w"> </span>xnat-central<span class="w"> </span>xnat:Xnat<span class="w"> </span>https://central.xnat.org<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--user<span class="w"> </span>user123<span class="w"> </span>--cache<span class="w"> </span>/work/xnat-cache
<span class="go">Password:</span>
</pre></div>
</div>
<p>This command will create a YAML configuration file for the store in the
<cite>~/.arcana/stores/</cite> directory. Authentication tokens are saved in the config
file instead of usernames and passwords, and will need to be
refreshed when they expire (see ‘<a class="reference internal" href="cli.html#arcana-store-refresh"><span class="std std-ref">arcana store refresh</span></a>’).</p>
<p>The CLI also contains commands for working with store entries that have already
been created</p>
<ul class="simple">
<li><p><a class="reference internal" href="cli.html#arcana-store-ls"><span class="std std-ref">arcana store ls</span></a> - list saved stores</p></li>
<li><p><a class="reference internal" href="cli.html#arcana-store-rename"><span class="std std-ref">arcana store rename</span></a> - rename a store</p></li>
<li><p><a class="reference internal" href="cli.html#arcana-store-remove"><span class="std std-ref">arcana store remove</span></a> - remove a store</p></li>
<li><p><a class="reference internal" href="cli.html#arcana-store-refresh"><span class="std std-ref">arcana store refresh</span></a> - refreshes authentication tokens saved for the store</p></li>
</ul>
<p>Alternatively, data stores can be configured via the Python API by initialising the
data store classes directly.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">arcana.medimage.data</span> <span class="kn">import</span> <span class="n">Xnat</span>

<span class="c1"># Initialise the data store object</span>
<span class="n">xnat_store</span> <span class="o">=</span> <span class="n">Xnat</span><span class="p">(</span>
    <span class="n">server</span><span class="o">=</span><span class="s1">&#39;https://central.xnat.org&#39;</span><span class="p">,</span>
    <span class="n">user</span><span class="o">=</span><span class="s1">&#39;user123&#39;</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;XNAT_PASS&#39;</span><span class="p">],</span>
    <span class="n">cache_dir</span><span class="o">=</span><span class="s1">&#39;/work/xnat-cache&#39;</span>
<span class="p">)</span>

<span class="c1"># Save it to the configuration file stored at &#39;~/.arcana/stores.yaml&#39; with</span>
<span class="c1"># the nickname &#39;xnat-central&#39;</span>
<span class="n">xnat_store</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;xnat-central&#39;</span><span class="p">)</span>

<span class="c1"># Reload store from configuration file</span>
<span class="n">reloaded</span> <span class="o">=</span> <span class="n">DataStore</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;xnat-central&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Data stores that don’t require any parameters such as <code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleStore</span></code> and
<code class="xref py py-class docutils literal notranslate"><span class="pre">Bids</span></code> don’t need to be configured and can be accessed via their aliases,
<code class="docutils literal notranslate"><span class="pre">file</span></code> and <code class="docutils literal notranslate"><span class="pre">bids</span></code> when defining a dataset.</p>
</div>
</section>
<section id="datasets">
<span id="id1"></span><h2>Datasets<a class="headerlink" href="#datasets" title="Permalink to this heading">#</a></h2>
<p>In Arcana, a <em>dataset</em> refers to a collection of comparable data within a store,
e.g. data from a single research study, or large collection such as the
Human Connectome Project. Arcana datasets consist of both source data and the
derivatives derived from them. Datasets are organised into trees that classify a
series of data points (e.g. imaging sessions) by a “hierarchy” of branches
(e.g. groups &gt; subjects &gt; sessions). For example, the following dataset consisting
of imaging sessions is sorted by subjects, then longintudinal timepoints</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>my-dataset
├── subject1
│   ├── timepoint1
│   │   ├── t1w_mprage
│   │   ├── t2w_space
│   │   └── bold_rest
│   └── timepoint2
│       ├── t1w_mprage
│       ├── t2w_space
│       └── bold_rest
├── subject2
│   ├── timepoint1
│   │   ├── t1w_mprage
│   │   ├── t2w_space
│   │   └── bold_rest
│   └── timepoint2
│       ├── t1w_mprage
│       ├── t2w_space
│       └── bold_rest
└── subject3
    ├── timepoint1
    │   ├── t1w_mprage
    │   ├── t2w_space
    │   └── bold_rest
    └── timepoint2
        ├── t1w_mprage
        ├── t2w_space
        └── bold_rest
</pre></div>
</div>
<p>The leaves of the tree contain data from specific “imaging session” data points,
as designated by the combination of one of the three subject IDs and
one of the two timepoint IDs.</p>
<p>While the majority of data items are stored in the leaves of the tree,
data can exist for any branch. For example, an analysis may use
genomics data, which will be constant for each subject, and therefore sits at
the subject level of the tree sit in special <em>SUBJECT</em> branches</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>my-dataset
├── subject1
│   ├── SUBJECT
│   │   └── geneomics.dat
│   ├── timepoint1
│   │   ├── t1w_mprage
│   │   ├── t2w_space
│   │   └── bold_rest
│   └── timepoint2
│       ├── t1w_mprage
│       ├── t2w_space
│       └── bold_rest
├── subject2
│   ├── SUBJECT
│   │   └── geneomics.dat
│   ├── timepoint1
│   │   ├── t1w_mprage
│   │   ├── t2w_space
│   │   └── bold_rest
│   └── timepoint2
│       ├── t1w_mprage
│       ├── t2w_space
│       └── bold_rest
└── subject3
    ├── SUBJECT
    │   └── geneomics.dat
    ├── timepoint1
    │   ├── t1w_mprage
    │   ├── t2w_space
    │   └── bold_rest
    └── timepoint2
        ├── t1w_mprage
        ├── t2w_space
        └── bold_rest
</pre></div>
</div>
<p>In the CLI, datasets are referred to by <code class="docutils literal notranslate"><span class="pre">&lt;store-nickname&gt;//&lt;dataset-id&gt;[&#64;&lt;dataset-name&gt;]</span></code>,
where <em>&lt;store-name&gt;</em> is the nickname of the store as saved by ‘<a class="reference internal" href="cli.html#arcana-store-add"><span class="std std-ref">arcana store add</span></a>’
(see <a class="reference internal" href="#stores"><span class="std std-ref">Stores</span></a>), and <em>&lt;dataset-id&gt;</em> is</p>
<ul class="simple">
<li><p>the file-system path to the data directory for file-system (and BIDS) stores</p></li>
<li><p>the project ID for XNAT stores</p></li>
</ul>
<p><em>&lt;dataset-id&gt;</em> is an optional component (“default” by default), which specifies a
unique namespace for the dataset, and derivatives created within it. This enables
multiple Arcana datasets to be defined on the same data, with different exclusion
criteria and analyses applied to them.</p>
<p>For example, a project called “MYXNATPROJECT” stored in
<a class="reference external" href="https://central.xnat.org">XNAT Central</a> using the <em>xnat-central</em> nickname
created in the <a class="reference internal" href="#stores"><span class="std std-ref">Stores</span></a> Section, would be <code class="docutils literal notranslate"><span class="pre">xnat-central//MYXNATPROJECT</span></code>.</p>
<p>Alternatively, dataset objects can be created directly via the Python API using
the <code class="xref py py-meth docutils literal notranslate"><span class="pre">DataStore.dataset()</span></code> method. For example, to define a new dataset
corresponding to <em>MYXNATPROJECT</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xnat_dataset</span> <span class="o">=</span> <span class="n">xnat_store</span><span class="o">.</span><span class="n">dataset</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;MYXNATPROJECT&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="items">
<span id="data-formats"></span><h2>Items<a class="headerlink" href="#items" title="Permalink to this heading">#</a></h2>
<p>Atomic items within a dataset are encapsulated by <code class="xref py py-class docutils literal notranslate"><span class="pre">DataType</span></code> objects.
There are three types of data items:</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">FileGroup</span></code> (single files, files + header/side-cars or directories)</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Field</span></code> (int, float, str or bool)</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ArrayField</span></code> (an array of int, float, str or bool)</p></li>
</ul>
<p>Instead of holding the data directly, data items reference files and
fields stored in the data store. Before data in remote stores
are accessed they need to be cached locally with <code class="xref py py-meth docutils literal notranslate"><span class="pre">DataType.get()</span></code>.
Newly created and modified data items are placed into the store with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">DataType.put()</span></code>.</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">FileGroup</span></code> is typically subclassed to specify the datatype of the
files/directories in the group. For example, there are a number common file
formats implemented in <code class="xref py py-mod docutils literal notranslate"><span class="pre">arcana.dirtree.data</span></code>, including</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dirtree.Text</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dirtree.Zip</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dirtree.Json</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dirtree.Directory</span></code></p></li>
</ul>
<p>File-group classes specify the extensions of the expected files/directories,
converters from alternative file formats, and may
also contain methods for accessing the headers and the contents of files
where applicable (e.g. <code class="xref py py-class docutils literal notranslate"><span class="pre">medimage.Dicom</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">medimage.NiftiGzX</span></code>).
Where a converter is specified from an alternative file format is specified,
Arcana will automatically run the conversion between the format required by
a pipeline and that stored in the data store. See <a class="reference internal" href="adding_formats.html#adding-formats"><span class="std std-ref">New formats and spaces</span></a> for detailed
instructions on how to specify new file formats and converters between them.</p>
<p>As with data stores, file formats are specified in the CLI by <em>&lt;module-path&gt;:&lt;class-name&gt;</em>,
e.g. <code class="docutils literal notranslate"><span class="pre">arcana.dirtree.data:Text</span></code>. However, if the datatype is in a submodule of
<code class="docutils literal notranslate"><span class="pre">arcana.data.types</span></code> then that prefix can be dropped for convenience,
e.g. <code class="docutils literal notranslate"><span class="pre">fileformats.text:Plain</span></code>.</p>
</section>
<section id="frames-rows-and-columns">
<span id="data-columns"></span><h2>Frames: Rows and Columns<a class="headerlink" href="#frames-rows-and-columns" title="Permalink to this heading">#</a></h2>
<p>Before data within a dataset can be manipulated by Arcana, they must be
assigned to a data frame. The “rows” of a data frame correspond to nodes
across a single layer of the data tree, such as</p>
<ul class="simple">
<li><p>imaging sessions</p></li>
<li><p>subjects</p></li>
<li><p>study groups (e.g. ‘test’ or ‘control’)</p></li>
</ul>
<p>and the “columns” are slices of comparable data items across each row, e.g.</p>
<ul class="simple">
<li><p>T1-weighted MR acquisition for each imaging session</p></li>
<li><p>a genetic test for each subject</p></li>
<li><p>an fMRI activation map derived for each study group.</p></li>
</ul>
<p>A data frame is defined by adding “source” columns to access existing
(typically acquired) data, and “sink” columns to define where
derivatives will be stored within the data tree. The “row frequency” argument
of the column (e.g. per ‘session’, ‘subject’, etc…) specifies which data frame
the column belongs to. The datatype of a column’s member items (see <a class="reference internal" href="#items"><span class="std std-ref">Items</span></a>)
must be consistent and is also specified when the column is created.</p>
<p>The data items (e.g. files, scans) within a source column do not need to have
consistent labels throughout the dataset although it makes it easier where possible.
To handle the case of inconsistent labelling, source columns can match single items
in each row of the frame based on several criteria:</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>path</strong> - label for the file-group or field</dt><dd><ul>
<li><p>scan type for XNAT stores</p></li>
<li><p>relative file path from row sub-directory for file-system/BIDS stores</p></li>
<li><p>is treated as a regular-expression if the <cite>is_regex</cite> flag is set.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>quality threshold</strong> - the minimum quality for the item to be included</dt><dd><ul>
<li><p>only applicable for <a class="reference external" href="https://xnat.org">XNAT</a> stores, where the quality can be set by UI or API</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>header values</strong> - header values are sometimes needed to distinguish file</dt><dd><ul>
<li><p>only available for selected item formats such as <code class="xref py py-class docutils literal notranslate"><span class="pre">medimage.Dicom</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>order</strong> - the order that an item appears the data row</dt><dd><ul>
<li><p>e.g. first T1-weighted scan that meets all other criteria in a session</p></li>
<li><p>only applicable for <a class="reference external" href="https://xnat.org">XNAT</a> stores</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>If no items, or multiple items are matched, then an error is raised. The <em>order</em>
flag, can be used to select one of muliple valid options.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">path</span></code> argument provided to sink columns defines where derived data will
be stored within the dataset:</p>
<ul class="simple">
<li><p>the resource name for XNAT stores.</p></li>
<li><p>the relative path to the target location for file-system stores</p></li>
</ul>
<p>Each column is assigned a name when it is created, which is used when
connecting pipeline inputs and outputs to the dataset and accessing the data directly.
The column name is used as the default value for the path of sink columns.</p>
<p>Use the ‘<a class="reference internal" href="cli.html#arcana-dataset-add-source"><span class="std std-ref">arcana dataset add-source</span></a>’ and ‘<a class="reference internal" href="cli.html#arcana-dataset-add-sink"><span class="std std-ref">arcana dataset add-sink</span></a>’
commands to add columns to a dataset using the CLI.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>arcana<span class="w"> </span>dataset<span class="w"> </span>add-source<span class="w"> </span><span class="s1">&#39;xnat-central//MYXNATPROJECT&#39;</span><span class="w"> </span>T1w<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>medimage:Dicom<span class="w"> </span>--path<span class="w"> </span><span class="s1">&#39;.*t1_mprage.*&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--order<span class="w"> </span><span class="m">1</span><span class="w"> </span>--quality<span class="w"> </span>usable<span class="w"> </span>--regex

<span class="gp">$ </span>arcana<span class="w"> </span>dataset<span class="w"> </span>add-sink<span class="w"> </span><span class="s1">&#39;/data/imaging/my-project&#39;</span><span class="w"> </span>fmri_activation_map<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>medimage:NiftiGz<span class="w"> </span>--row-frequency<span class="w"> </span>group
</pre></div>
</div>
<p>Alternatively, the <a class="reference internal" href="api.html#arcana.core.data.set.Dataset.add_source" title="arcana.core.data.set.Dataset.add_source"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Dataset.add_source()</span></code></a> and <a class="reference internal" href="api.html#arcana.core.data.set.Dataset.add_sink" title="arcana.core.data.set.Dataset.add_sink"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Dataset.add_sink()</span></code></a>
methods can be used directly to add sources and sinks via the Python API.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">arcana.medimage.data</span> <span class="kn">import</span> <span class="n">Clinical</span>
<span class="kn">from</span> <span class="nn">fileformats.medimage.data</span> <span class="kn">import</span> <span class="n">Dicom</span><span class="p">,</span> <span class="n">NiftiGz</span>

<span class="n">xnat_dataset</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;T1w&#39;</span><span class="p">,</span>
    <span class="n">path</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;.*t1_mprage.*&#39;</span>
    <span class="n">datatype</span><span class="o">=</span><span class="n">Dicom</span><span class="p">,</span>
    <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">quality_threshold</span><span class="o">=</span><span class="s1">&#39;usable&#39;</span><span class="p">,</span>
    <span class="n">is_regex</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">fs_dataset</span><span class="o">.</span><span class="n">add_sink</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;brain_template&#39;</span><span class="p">,</span>
    <span class="n">datatype</span><span class="o">=</span><span class="n">NiftiGz</span><span class="p">,</span>
    <span class="n">row_frequency</span><span class="o">=</span><span class="s1">&#39;group&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>To access the data in the columns once they are defined use the <code class="docutils literal notranslate"><span class="pre">Dataset[]</span></code>
operator</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">arcana.core.data.set</span> <span class="kn">import</span> <span class="n">Dataset</span>

<span class="c1"># Get a column containing all T1-weighted MRI images across the dataset</span>
<span class="n">xnat_dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;xnat-central//MYXNATPROJECT&#39;</span><span class="p">)</span>
<span class="n">t1w</span> <span class="o">=</span> <span class="n">xnat_dataset</span><span class="p">[</span><span class="s1">&#39;T1w&#39;</span><span class="p">]</span>

<span class="c1"># Plot a slice of the image data from a Subject sub01&#39;s imaging session</span>
<span class="c1"># at Timepoint T2. (Note: such data access is only available for selected</span>
<span class="c1"># data formats that have convenient Python readers)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">t1w</span><span class="p">[</span><span class="s1">&#39;T2&#39;</span><span class="p">,</span> <span class="s1">&#39;sub01&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">30</span><span class="p">])</span>
</pre></div>
</div>
<p>One of the main benefits of using datasets in <a class="reference external" href="https://bids.neuroimaging.io">BIDS</a> datatype is that the names
and file formats of the data are strictly defined. This allows the <code class="xref py py-class docutils literal notranslate"><span class="pre">Bids</span></code>
data store object to automatically add sources to the dataset when it is
initialised.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">arcana.bids.data</span> <span class="kn">import</span> <span class="n">Bids</span>
<span class="kn">from</span> <span class="nn">arcana.medimage.data</span> <span class="kn">import</span> <span class="n">Clinical</span>

<span class="n">bids_dataset</span> <span class="o">=</span> <span class="n">Bids</span><span class="p">()</span><span class="o">.</span><span class="n">dataset</span><span class="p">(</span>
    <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;/data/openneuro/ds00014&#39;</span><span class="p">)</span>

<span class="c1"># Print dimensions of T1-weighted MRI image for Subject &#39;sub01&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bids_dataset</span><span class="p">[</span><span class="s1">&#39;T1w&#39;</span><span class="p">][</span><span class="s1">&#39;sub01&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;dim&#39;</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="spaces">
<span id="data-spaces"></span><h2>Spaces<a class="headerlink" href="#spaces" title="Permalink to this heading">#</a></h2>
<p>In addition to data frames corresponding to row frequencies that explicitly
appear in the hierarchy of the data tree (see <a class="reference internal" href="#data-columns"><span class="std std-ref">Frames: Rows and Columns</span></a>),
there are a number of frames that are implied and may be needed to store
derivatives of a particular analysis. In clinical imaging research studies/trials,
imaging sessions are classified by the subject who was scanned and, if applicable,
the longitudinal timepoint. The subjects themselves are often classified by which
group they belong to. Therefore, we can factor imaging session
classifications into</p>
<ul class="simple">
<li><p><strong>group</strong> - study group (e.g. ‘test’ or ‘control’)</p></li>
<li><dl class="simple">
<dt><strong>member</strong> - ID relative to group</dt><dd><ul>
<li><p>can be arbitrary or used to signify control-matched pairs</p></li>
<li><p>e.g. the ‘03’ in ‘TEST03’ &amp; ‘CONT03’ pair of control-matched subject IDs</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><strong>timepoint</strong> - longintudinal timepoint</p></li>
</ul>
<p>In Arcana, these primary classifiers are conceptualised as “axes” of a
“data space”, in which data points (e.g. imaging sessions) are
laid out on a grid.</p>
<p>Depending on the hierarchy of the data tree, data belonging to these
axial frequencies may or may not have a corresponding branch to be stored in.
In these cases, new branches are created off the root of the tree to
hold the derivatives. For example, average trial performance data, calculated
at each timepoint and the age difference between matched-control pairs, would
need to be stored in new sub-branches for timepoints and members, respectively.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>my-dataset
├── TIMEPOINT
│   ├── timepoint1
│   │   └── avg_trial_performance
│   └── timepoint2
│       └── avg_trial_performance
├── MEMBER
│   ├── member1
│   │   └── age_diff
│   └── member2
│       └── age_diff
├── group1
│   ├── member1
│   │   ├── timepoint1
│   │   │   ├── t1w_mprage
│   │   │   ├── t2w_space
│   │   │   └── bold_rest
│   │   └── timepoint2
│   │       ├── t1w_mprage
│   │       ├── t2w_space
│   │       └── bold_rest
│   └── member2
│       ├── timepoint1
│       │   ├── t1w_mprage
│       │   ├── t2w_space
│       │   └── bold_rest
│       └── timepoint2
│           ├── t1w_mprage
│           ├── t2w_space
│           └── bold_rest
└── group2
    |── member1
    │   ├── timepoint1
    │   │   ├── t1w_mprage
    │   │   ├── t2w_space
    │   │   └── bold_rest
    │   └── timepoint2
    │       ├── t1w_mprage
    │       ├── t2w_space
    │       └── bold_rest
    └── member2
        ├── timepoint1
        │   ├── t1w_mprage
        │   ├── t2w_space
        │   └── bold_rest
        └── timepoint2
            ├── t1w_mprage
            ├── t2w_space
            └── bold_rest
</pre></div>
</div>
<p>In this framework, <code class="docutils literal notranslate"><span class="pre">subject</span></code> IDs are equivalent to the combination of
<code class="docutils literal notranslate"><span class="pre">group</span> <span class="pre">+</span> <span class="pre">member</span></code> IDs and <code class="docutils literal notranslate"><span class="pre">session</span></code> IDs are equivalent to the combination of
<code class="docutils literal notranslate"><span class="pre">group</span> <span class="pre">+</span> <span class="pre">member</span> <span class="pre">+</span> <span class="pre">timepoint</span></code> IDs. There are,  2<sup>N</sup> combinations of
the axial frequencies for a given data tree, where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the depth of the tree
(i.e. <code class="docutils literal notranslate"><span class="pre">N=3</span></code> in this case).</p>
<p>Note that the grid of a particular dataset can have a single point along any
given dimension (e.g. one study group or timepoint) and still exist in the data
space. Therefore, when creating data spaces it is better to be inclusive of
potential categories to make them more general.</p>
<p>All combinations of the data spaces axes are given a name within
<a class="reference internal" href="api.html#arcana.core.data.space.DataSpace" title="arcana.core.data.space.DataSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataSpace</span></code></a> enums. In the case of the <code class="xref py py-class docutils literal notranslate"><span class="pre">medimage.Clinical</span></code>
data space, the members are</p>
<ul class="simple">
<li><p><strong>group</strong> (group)</p></li>
<li><p><strong>member</strong> (member)</p></li>
<li><p><strong>timepoint</strong> (timepoint)</p></li>
<li><p><strong>session</strong> (member + group + timepoint),</p></li>
<li><p><strong>subject</strong> (member + group)</p></li>
<li><p><strong>batch</strong> (group + timepoint)</p></li>
<li><p><strong>matchedpoint</strong> (member + timepoint)</p></li>
<li><p><strong>dataset</strong> ()</p></li>
</ul>
<p>If they are not present in the data tree, alternative row frequencies are
stored in new branches under the dataset root, in the same manner as data space
axes</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>my-dataset
├── BATCH
│   ├── group1_timepoint1
│   │   └── avg_connectivity
│   ├── group1_timepoint2
│   │   └── avg_connectivity
│   ├── group2_timepoint1
│   │   └── avg_connectivity
│   └── group2_timepoint2
│       └── avg_connectivity
├── MATCHEDPOINT
│   ├── member1_timepoint1
│   │   └── comparative_trial_performance
│   ├── member1_timepoint2
│   │   └── comparative_trial_performance
│   ├── member2_timepoint1
│   │   └── comparative_trial_performance
│   └── member2_timepoint2
│       └── comparative_trial_performance
├── group1
│   ├── member1
│   │   ├── timepoint1
│   │   │   ├── t1w_mprage
│   │   │   ├── t2w_space
│   │   │   └── bold_rest
│   │   └── timepoint2
│   │       ├── t1w_mprage
│   │       ├── t2w_space
│   │       └── bold_rest
│   └── member2
│       ├── timepoint1
│       │   ├── t1w_mprage
│       │   ├── t2w_space
│       │   └── bold_rest
│       └── timepoint2
│           ├── t1w_mprage
│           ├── t2w_space
│           └── bold_rest
└── group2
    |── member1
    │   ├── timepoint1
    │   │   ├── t1w_mprage
    │   │   ├── t2w_space
    │   │   └── bold_rest
    │   └── timepoint2
    │       ├── t1w_mprage
    │       ├── t2w_space
    │       └── bold_rest
    └── member2
        ├── timepoint1
        │   ├── t1w_mprage
        │   ├── t2w_space
        │   └── bold_rest
        └── timepoint2
            ├── t1w_mprage
            ├── t2w_space
            └── bold_rest
</pre></div>
</div>
<p>For stores that support datasets with arbitrary tree structures
(i.e. <code class="xref py py-class docutils literal notranslate"><span class="pre">DirTree</span></code>), the “data space” and the hierarchy of layers
in the data tree needs to be provided. Data spaces are explained in more
detail in <a class="reference internal" href="#data-spaces"><span class="std std-ref">Spaces</span></a>. However, for the majority of datasets in the
medical imaging field, the <code class="xref py py-class docutils literal notranslate"><span class="pre">arcana.medimage.data.Clinical</span></code> space is
appropriate.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">arcana.dirtree</span> <span class="kn">import</span> <span class="n">DirTree</span>
<span class="kn">from</span> <span class="nn">arcana.medimage.data</span> <span class="kn">import</span> <span class="n">Clinical</span>

<span class="n">fs_dataset</span> <span class="o">=</span> <span class="n">DirTree</span><span class="p">()</span><span class="o">.</span><span class="n">dataset</span><span class="p">(</span>
    <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;/data/imaging/my-project&#39;</span><span class="p">,</span>
    <span class="c1"># Define the hierarchy of the dataset in which imaging session</span>
    <span class="c1"># sub-directories are separated into directories via their study group</span>
    <span class="c1"># (i.e. test &amp; control)</span>
    <span class="n">space</span><span class="o">=</span><span class="n">Clinical</span><span class="p">,</span>
    <span class="n">hierarchy</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="s1">&#39;session&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>For datasets where the fundamental hierarchy of the storage system is fixed
(e.g. XNAT), you may need to infer the data point IDs along an axis
by decomposing a branch label following a given naming convention.
This is specified via the <code class="docutils literal notranslate"><span class="pre">id-inference</span></code> argument to the dataset definition.
For example, given a an XNAT project with the following structure and a naming
convention where the subject ID is composed of the group and member ID,
<em>&lt;GROUPID&gt;&lt;MEMBERID&gt;</em>, and the session ID is composed of the subject ID and timepoint,
<em>&lt;SUBJECTID&gt;_MR&lt;TIMEPOINTID&gt;</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>MY_XNAT_PROJECT
├── TEST01
│   └── TEST01_MR01
│       ├── t1w_mprage
│       └── t2w_space
├── TEST02
│   └── TEST02_MR01
│       ├── t1w_mprage
│       └── t2w_space
├── CONT01
│   └── CONT01_MR01
│       ├── t1w_mprage
│       └── t2w_space
└── CONT02
    └── CONT02_MR01
        ├── t1w_mprage
        └── t2w_space
</pre></div>
</div>
<p>IDs for group, member and timepoint can be inferred from the subject and session
IDs, by providing the frequency of the ID to decompose and a
regular-expression (in Python syntax) to decompose it with. The regular
expression should contain named groups that correspond to row frequencies of
the IDs to be inferred, e.g.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>arcana<span class="w"> </span>dataset<span class="w"> </span>define<span class="w"> </span><span class="s1">&#39;xnat-central//MYXNATPROJECT&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--id-inference<span class="w"> </span>subject<span class="w"> </span><span class="s1">&#39;(?P&lt;group&gt;[A-Z]+)_(?P&lt;member&gt;\d+)&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--id-inference<span class="w"> </span>session<span class="w"> </span><span class="s1">&#39;[A-Z0-9]+_MR(?P&lt;timepoint&gt;\d+)&#39;</span>
</pre></div>
</div>
</section>
<section id="grids">
<span id="data-grids"></span><h2>Grids<a class="headerlink" href="#grids" title="Permalink to this heading">#</a></h2>
<p>Often there are data points that need to be removed from a given
analysis due to missing or corrupted data. Such sections need to be removed
in a way that the data points still lie on a rectangular grid within the
data space (see <a class="reference internal" href="#data-spaces"><span class="std std-ref">Spaces</span></a>) so derivatives computed over a given axis
or axes are drawn from comparable number of data points.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Somewhat confusingly the “data points” referred to in this section
actually correspond to “data rows” in the frames used in analyses.
However, you can think of a 2 or 3 (or higher) dimensional grid as
being flattened out into a 1D array to form a data frame in the
same way as numpy’s <code class="docutils literal notranslate"><span class="pre">ravel()</span></code> method does to higher dimensional
arrays. The different types of data collected at each data point
(e.g. imaging session) can then be visuallised as expanding out to
form the row of the data frame.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">--exclude</span></code> option is used to specify the data points to exclude from
a dataset.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>arcana<span class="w"> </span>dataset<span class="w"> </span>define<span class="w"> </span><span class="s1">&#39;/data/imaging/my-project@manually_qcd&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>medimage:Clinical<span class="w"> </span>subject<span class="w"> </span>session<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--exclude<span class="w"> </span>member<span class="w"> </span><span class="m">03</span>,11,27
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">include</span></code> argument is the inverse of exclude and can be more convenient when
you only want to select a small sample or split the dataset into sections.
<code class="docutils literal notranslate"><span class="pre">include</span></code> can be used in conjunction with <code class="docutils literal notranslate"><span class="pre">exclude</span></code> but not for the same
frequencies.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>arcana<span class="w"> </span>dataset<span class="w"> </span>define<span class="w"> </span><span class="s1">&#39;/data/imaging/my-project@manually_qcd&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>medimage:Clinical<span class="w"> </span>subject<span class="w"> </span>session<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--exclude<span class="w"> </span>member<span class="w"> </span><span class="m">03</span>,11,27<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--include<span class="w"> </span>timepoint<span class="w"> </span><span class="m">1</span>,2
</pre></div>
</div>
<p>You may want multiple dataset definitions for a given project/directory,
for different analyses e.g. with different subsets of IDs depending on which
scans have passed quality control, or to define training and test datasets
for machine learning. To keep these analyses separate, you can
assign a dataset definition a name, which is used differentiate between multiple
definitions stored in the same dataset project/directory. To do this via the
CLI, append the name to the dataset’s ID string separated by ‘::’, e.g.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>arcana<span class="w"> </span>dataset<span class="w"> </span>define<span class="w"> </span><span class="s1">&#39;/data/imaging/my-project@training&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>medimage:Clinical<span class="w"> </span>group<span class="w"> </span>subject<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--include<span class="w"> </span>member<span class="w"> </span><span class="m">10</span>:20
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="processing.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Processing</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="getting_started.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Getting started</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Thomas G. Close
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Data model</a><ul>
<li><a class="reference internal" href="#stores">Stores</a></li>
<li><a class="reference internal" href="#datasets">Datasets</a></li>
<li><a class="reference internal" href="#items">Items</a></li>
<li><a class="reference internal" href="#frames-rows-and-columns">Frames: Rows and Columns</a></li>
<li><a class="reference internal" href="#spaces">Spaces</a></li>
<li><a class="reference internal" href="#grids">Grids</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    </body>
</html>