name: example
store-version: 1.0.0
metadata:  # Primarily required for BIDS export
  title: A sample dataset with subjects with high motion excluded
  acknowledgements: null
  authors:
  - name: Thomas G. Close
    email: thomas.close@sydney.edu.au
  doi: null
  ethics_approvals: []
  funding: []
  generated_by:
  - code_url: https://github.com/ArcanaFramework/arcana
    container: null
    description: dataset definition was generated by Arcana CLI
    name: arcana
    version: 0.9.8
  how_to_acknowledge: see licence
  license: CC0
  description: >-
    this dataset is an example to demonstrate all potential features of an Arcana dataset
    definition
  references: []
  row_keys: []
  sources: []
  type: derivative
grid:
  space: /clinical  # This could be extended
  hierarchy:  # This is fixed for XNAT
  - subject
  - session
  id_patterns:
    group: "subject::(\\w+)\\d+"
    member: "subject::\\w+(\\d+)"
    visit: "visit_#session:visit_id:VISIT(\\d+)#"
  include:
    visit:
    - 01
    - 02
  exclude:
    subject:
    - CONT04
    - TEST11
  sources:
    anat/t1w:
      datatype:
        format: medimage/dicom-series
        classifiers:
          species: human
          region: brain
          modality: mri
          contrast: t1w
      is_regex: true
      order: -1  # select last scan matching ".*mprage.*" in session
      path: "*.mprage.*"
      quality_threshold: usable
      row_frequency: session
      metadata_schema: null
    anat/flair:
      datatype:
        format: medimage/dicom-series
        classifiers:
          species: human
          region: brain
          modality: mri
          contrast: flair
      is_regex: false
      order: null
      path: ".*flair.*"
      quality_threshold: usable
      row_frequency: session
      metadata_schema: null
  sinks:
    brain_mask:
      datatype:
        format: medimage/nifti-gz-x
      path: brain_mask@
      row_frequency: session
    brain_template:
      datatype:
        format: medimage/nifti-gz-x
      path: brain-template@
      row_frequency: dataset
  partitions:
    bloods:
      free_axes:
      - visit  # Bloods are only collected in a single visit whereas there are >2 MRI sessions
      selection:
        session: ".*_BLD"  # matches pecial sessions under each subject named *_BLD
      sources:
        hematocrit:
          path: "HAEM.*"
          datatype:
            format: text/csv
          row_frequency: session
        glucose:
          path: "GLU.*"
          datatype:
            format: text/csv
          row_frequency: session
    rest:
      constant_ids:
        task: rest
      sources:
        anat/bold_task-rest:
          path: ".*bold.*"
          order: 0  # First fMRI acquisition is assumed to be REST
          datatype:
            format: medimage/dicom-series
            classifiers:
              species: human
              region: brain
              modality: mri
              contrast: bold
          row_frequency: session_task
          quality_threshold: usable
    finger_tapping:
      constant_ids:
        task: fingertap
      sources:
        anat/bold_task-fingertap:
          path: ".*bold.*"
          order: 1  # Second fMRI acquisition is assumed to be a finger-tapping task
          datatype:
            format: medimage/dicom-series
            classifiers:
              species: human
              region: brain
              modality: mri
              contrast: bold
          row_frequency: session_task
          quality_threshold: usable
    recall:
      constant_ids:
        task: recall
      sources:
        anat/bold_task-recall:
          path: ".*bold.*"
          order: 2  # Third fMRI acquisition is assumed to be a finger-tapping task
          datatype:
            format: medimage/dicom-series
            classifiers:
              species: human
              region: brain
              modality: mri
              contrast: bold
          row_frequency: session_task
          quality_threshold: usable
applied:
  pipelines: {}
  analyses: {}
pkg_versions:
  arcana: 0.9.8
  fileformats: 0.5.0
